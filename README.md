# 摄像头AI分析系统

一个基于Web的摄像头智能分析工具，支持Excel批量导入摄像头数据，并提供AI驱动的场景分析功能。

## 主要功能

### 1. Excel批量导入
- 支持上传Excel文件（.xlsx, .xls格式）
- 自动解析摄像头名称、经度、纬度数据
- 批量在地图和左侧面板显示摄像头

### 2. 摄像头管理
- 动态添加、编辑、删除摄像头
- 实时更新摄像头状态（在线/离线/维护中）
- 地图标记与左侧列表同步显示

### 3. AI场景分析
- 上传摄像头实时画面
- 自动生成30米区域平面图
- 可调节视野角度（30°-120°）和视野距离（20-100米）
- 自定义分析提示词
- 基于AI模型进行场景识别和分析

## 使用方法

### 1. 启动服务
```bash
python app.py
```
服务将在 http://127.0.0.1:5001 启动

### 2. Excel/CSV文件格式
创建一个Excel文件(.xlsx/.xls)或CSV文件，包含以下列：
- 第一列：摄像头名称
- 第二列：经度
- 第三列：纬度

**Excel格式示例：**
```
摄像头名称,经度,纬度
摄像头-001,114.211150,22.700347
摄像头-002,114.214657,22.698320
摄像头-003,114.214662,22.698321
```

**CSV格式示例：**
```
摄像头名称,经度,纬度
摄像头-001,114.211150,22.700347
摄像头-002,114.214657,22.698320
摄像头-003,114.214662,22.698321
```

**注意：** 如果Excel文件出现中文乱码，建议使用CSV格式，确保文件保存为UTF-8编码。

### 3. 使用步骤

1. **导入摄像头数据**
   - 点击左侧面板的"选择文件"按钮
   - 选择符合格式的Excel文件
   - 系统会自动解析并在地图上显示摄像头

2. **编辑摄像头**
   - 点击地图上的摄像头标记或左侧列表中的"编辑"按钮
   - 在弹出的模态框中可以：
     - 修改摄像头名称和状态
     - 上传摄像头画面
     - 调整视野参数
     - 生成或上传地图截图

3. **AI分析**
   - 上传摄像头画面
   - 调整视野角度和距离
   - 生成地图截图
   - 编写分析提示词
   - 点击"开始分析"获取AI分析结果

## 技术特性

- **响应式设计**：适配不同屏幕尺寸
- **实时预览**：滑块调节时实时更新地图截图
- **拖拽界面**：模态框支持拖拽移动
- **状态管理**：完整的摄像头生命周期管理
- **AI集成**：集成SiliconFlow API进行智能分析

## 文件结构

```
camera_insight_demo/
├── app.py                 # Flask后端服务
├── static/
│   └── index.html        # 主界面
├── requirements.txt      # Python依赖
├── camera_template.xlsx  # Excel模板文件
└── README.md            # 说明文档
```

## 环境要求

- Python 3.7+
- Flask
- 网络连接（用于地图加载和AI分析）

## 配置说明

在 `app.py` 中需要配置：
- `SILICONFLOW_API_KEY`：SiliconFlow API密钥
- 端口号：默认5001

## 注意事项

1. 确保Excel文件格式正确，第一行为标题行
2. 经度和纬度必须是有效的数值
3. 需要有效的API密钥才能使用AI分析功能
4. 地图加载需要网络连接 